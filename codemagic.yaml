workflows:
  my-workflow:
    name: My workflow name
    instance_type: mac_mini
    max_build_duration: 60
    environment:
      vars:
        #APP_STORE_CONNECT_ISSUER_ID: Encrypted(Z0FBQUFBQmdyWEk2aXJESHpFZzAzNmZGMUw0VzMtVWVlemoxU3EyUUlKTE5QTVRqQUlfdXVyMWxMc0JRWkhlUWo5c2lHYm1BWWNidm03OVIza3FkUUszRkpjUWdQcDh4SE9CZ1lLaDdJa2Y0RFJyMDd3eVd2MU1ja0RkbzFSNHJ6cEtPT2xVOGJmazE=)
        #APP_STORE_CONNECT_KEY_IDENTIFIER: Encrypted(Z0FBQUFBQmdyWEoyTS0yUzV5SGxYajV2RExLdm1RUXo5MFBSam1YNUY0TUEyQzBUTWdXcm9SVUt5WFFvekVRZC1HSXRVWjFjeG1oQ2xLUXhZMHhHNzlVQkp1cDNVdjBXeGc9PQ==)
        #APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdyWExuSU1qQ1lVUk44T2tLaDRHRzVMeUg3T2tfMW9RSllIOVBON2lXOGpNQnVaLUY1X0otbV9jUEpGZG1OdHEtQ3kxaTFCaFlBMjYwVjJQTXBNYVBDeUdWN0QzT3BnbTBUR2NjVWhyaTBVV2lmazZUMF9OWUgzRFBtWGdQNzBtc2VfVWJCeTRLUUdQd1ZnaVdjTG9Fczl4a1FhYnpKSV9ZbDFJOEhMNXhTRlhjYUNMaDZvd1k1cEtsZUtaZnYxWU9lS3hjdUd3bUFsNGlJaVRXN3N5MW1iRDFPSUswTlQ1OVhablhoY2FDV2dlN2lxTzFQLU5LOGpFal9iUE1CblpvRHJqM0M5am16Y0p3bzFYN0NFblZ3TzJrRUdZc1lLR1p0YmI1RmFBbGhTeHUzVWZaR1VyRTZNR1hZcmswVVZCX1hCUmNFM1Rtcm9BVktweGpHZnM3ZlNFNW5xamJCMDN1eFgtenF6NFBDZ18zcDNmNTVYS3BJY1Bfd3BobFVuQVlGWEdWdmV3aGdnQVVOOVl4R2ZybGZBa2FfTnlEMWFucWJoMGJEOEpOZTNPR2RWWT0=)
        #CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdmQ0x0Sjk1eS1HVVpxNzBPbjk3V2c0bUpEVk84LWRrcjhxME4wQ2duR2I5NjBjdFRHNkhsVEMza1pWcHZ5aTRNQTVFdVlJUk9GZU1ZZnhISnY0UWFPQmE1d2lLZ2RpZkdrVERMZmJqanNXNjV6U0hLQmlQVU5KbE5aWTVKR0Q1NnFPSDdRcHIxZFQ1SnRvc1VXM1BIOHl0bGMwWmVYYkR1aDZqY0MyM0x2ejlQVy13UVl4M0kzQmdwbGFOeTdUZWxBU2o3aWg3UFZYV1RWM1pLSS1nQUJ5Qmh3UXJrX0diaS1JdE1mb1ZOcHAweWRuR0ktWm9TQkhkZUkzamhpVnB0dXRiVHJDd29BWExRZ0VuLVNTMGRtSC13VzU2YzV2dmZKaUVaSnc5M2stWGN4SzlMdTdLNlNxUFVJY29QYnNkaEZzT3QxcTBnWEFLek9BM09qOUxPbXpxOUc0U3FyaXBReUxVZXBSeHJna2tJdjJnU2lvMFJTQ3VNQThRUG5GMWNvQ0RFcVRqSnllVS1jU2RlSVF3aG9fVTd2Y1BiZHd0SHBlTTkyT00wTFFvaEdrX3NQN3dYeG1CZVlfNTZXNG0zb3hSTExSSENTMXEzQlU0LVdpRGRFbDc2NlRPNEZRTENuTUJfMWhTZ0VVQ2t4M3o0d1BaaEkwZGVPR19oWEdRT08yQmdfQk5obE85ZWVjWHF0YUpPZ1R4ODlZZkwxelRhZlpCbjkyV1VraG9ONHlkMVNsUkN2SXF2ZUoxcHhqcmZJdENlTF9OTUhmSHdLaGxUSzJPVVd2S1RoaGxXaURvUlg5ZDZVNlZQaEZoRlVWQVMzSE1EdFU2ZHI1Q3RhbUVESU9YZ0lpN1hiTjVlbEpuVm5ETEVCTVIwclpGcWJxRGs2R202Y2lNMTJ2ckZoR05OVHRBN2hGcXRiMjVFSVBhclZ6NW5mUkljNXZhSFZ6Z2k5YzY0X1BQaDBnaHhQbW1ZWEh3YWNRTS1WN1VmRlNQcFRLQnlaamFPWDlTbFhsTEhXQ2xpcGpUNHE5SkM3Vzc5Y3RyWVdhTUhZeTNfNW5KOXE2TGNoQ1JGTE9od1hTUS04RFFUNURUQkIyamFJMDJJa0x0V2Q2WC1vNEpXSFlhaFdWOTZjbWpvc21TWmVITzFKTVhwcjRKZElsMmhTQnNPd0dzZEpqTGNHLTFZdDc4MGpCSUNCU3RkMkVYQnN5cTQxd2ZqaUh4V3g2eHpVd3N4NTNNc3Q3Rnhna0daMWU1bVFGWVJlb0VOUzIwR3JwWHc5Qlh3OF9fdnVZcVEtNXdPRFpidzZXUWZJUVByeE8zbnotQ190dHJfX1hBWHU0czI2dGcycjBJaGZ0WC0yMzVkbFBaLUR0X2dYeU1ReDlEbmIxekVpcGZlS0dUZVBqSW5Pbm5ra01hbDhidHROVmNhR1lPTEtIUGtLZW9pTVAzOVB2cm1tczVZeGJzVEUtQzNLMERHRXpIVWU3QlZhUnp4c1pGMnZacXBtSXZxenpHdDBkQWFNUDV3eDROeDhWYXVweVZYVFJ5cVpNc2hBQWh6bGFzbFZnUFRKTE5Nd2s0U1BDRkhsMXdPcXVMajBVS280dmxPVkxGa2RVeEI3ODdnNXVHQi03ZnNXbG82ZG00dmw3MWFjQ0tBZE42SkxNN2ZKZFFVcXpXal81b0lzQ0VnWXhpWUxiNFkwdzktXy1kaDJXY0ZPOS1vQ0Yzb1dVSUFTazdlM0U1d1pGOEhuNnZZWG84T0ZTVmNJR29TSVhtbHJMVUxHTndJTUFwWDhDeElqMEJnWUVMNXVtbFFkSTBWdnpZbHZrOFFPVnNUclNCeUZ0Y3lYNlpHbWZJZlF0akJneEdIRGlmbG1XenpEX2wtY0lXZU42ZUtwdndFUFlRWG95dmFMYlM4NDkybXN0eC1ZbUhuR0kySHVaMXdxRU00YVp2UlVVWTRxUDR0Y2dkcmNhQ1ZWc0FWZ3g3bEc0dWR2elJfTGdZdW1HbDVsYS01T2IzRHY0ZTg0cFRVS3JCZ0dPNVp3R1g0eGg1a2trUXJSY2s4WVplWk1STTllS2phTXNpV0M4NGZobE9KcG9meHFfREp1VXFpTkhsTmVRZFlaenRmYnJuY2FvT0wyOVZ2RmEwdk9WWlR5Q3lxNURkZnU0Q1VjMldNcUJSMnk2VXlOLWJhUENlZGtuV2h0cVQyRmJWWVFSc3NIbkFzMlZzYUUzY203OFF0MmQtQldZX1IxNjZscm5obVN6Rl93eDlzZm9WWkMwbEJjejVCbE5XVkw1bVRpX01QNUJJdjYxdzFDTzlOMVNaSDlNdEt1VFFjRF9oQlFuNWdiVFQ3clhLWmtRV1o0ZjhtTUhyWXJDRk9pYTZyRXhKelJwTTRlamMydDRudEVZZVV3aUVPRklKQ05lbl9KWmQ3ZnJLbE8wXzBjQ3ZyYUU5bVRLNWRIZU1xR21aQXNJc3d3aGswcmNQeTBuSUJNM1VRUWQ2N1lDdjY3cmdZSEVEWnU5bWgzNkplMWlPUkxsTWFNUTYwMk9ZOGZSZUFYbWhtSHo1TVdOSWtTZjBWRVlVVVlsVlo5Zi1Nc0tiSFBpb2hYTjhNeW9NLTVQZXp3YWl0WVc0alJLdHpSV2R2MEpkYk1JbnlIdDBxTEE4NTBOQWZRajZQdDIybV9oU3dkV0lMbm9pMlhkN1dTRHE1cnV6RUFhbkgwRXdRcFpCWDRTRF9vUGtyV2l2bjFGN0xFSFEtU0h0bjItS1VfSjlmRkdnendEXy1QY3RlTzlVLWRUeW5RTFNLR29Ebm5Rdk9wWEFRS3cydlBQWUplUkhHOW5YVE1wc3pIMjdqclRkZFdhT2ppanB1b3NXSUowbldidjdHWXIta2JXak1iM3M0Ylh4UFpNZG96ZWFPSjdGU3dRWkNFVWZ3eGlVQjVuY0dBLXZBQjlxWHV6X2hWeVBzX2Z5NTVJN19lXzFpLWlfLUNHdEFFb0NQR1BnUnFXS1dtQVRheXZxaHZPZ2tmRlJEU0g4cVpvUlpKYmcwZ0lGQ1lsS1VzLXo4NWpESEdlWGRsSV8yaFJhZ3hJMFM1bHZ0)
      flutter: stable
      xcode: latest
    cache:
      cache_paths:
        - ~/.pub-cache
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
      cancel_previous_builds: false
    scripts:
      - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
        script: keychain initialize
      - name: Fetch signing files
        script: app-store-connect fetch-signing-files "$(xcode-project detect-bundle-id)" --type IOS_APP_STORE --create
      - name: Set up signing certificate
        script: keychain add-certificates
      - name: Set up code signing settings on Xcode project
        script: xcode-project use-profiles
      - name: build
        script: flutter build ipa --export-options-plist=/Users/builder/export_options.plist
    artifacts:
      - build/ios/ipa/*.ipa
      - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
    publishing:
      email:
        recipients:
          - c.maouche@esi-sba.dz
